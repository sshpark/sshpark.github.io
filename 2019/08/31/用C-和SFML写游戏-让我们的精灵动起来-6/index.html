<!DOCTYPE html>
<html lang="zh-cn">
  <head><meta charset="UTF-8"/>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="ç”¨C++å’ŒSFMLå†™æ¸¸æˆ-è®©æˆ‘ä»¬çš„ç²¾çµåŠ¨èµ·æ¥ï¼ˆ6ï¼‰"/><meta name="keywords" content="SFML, ç”¨C++å’ŒSFMLå†™æ¸¸æˆ, sshpark" /><link rel="alternate" href="/atom.xml" title="sshpark"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0" />
<link rel="canonical" href="http://sshpark.com.cn/2019/08/31/ç”¨C-å’ŒSFMLå†™æ¸¸æˆ-è®©æˆ‘ä»¬çš„ç²¾çµåŠ¨èµ·æ¥-6/"/>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\(','\)']] } });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<script id="baidu_analytics">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?df6c0480b02517594e4a02db8f89fbcb";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script><script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script src="//cdn1.lncld.net/static/js/3.1.1/av-min.js"></script>
  <script id="leancloud">
    AV.init({
      appId: "jMG2YYii7aWm9mTVyeeNa3fi-gzGzoHsz",
      appKey: "Hc4f0RfAVP3HQwmQkkDfgImA"
    });
  </script><script>
  window.config = {"leancloud":{"app_id":"jMG2YYii7aWm9mTVyeeNa3fi-gzGzoHsz","app_key":"Hc4f0RfAVP3HQwmQkkDfgImA"},"toc":true,"fancybox":false,"pjax":"","latex":true};
</script>

    <title>ç”¨C++å’ŒSFMLå†™æ¸¸æˆ-è®©æˆ‘ä»¬çš„ç²¾çµåŠ¨èµ·æ¥ï¼ˆ6ï¼‰ - sshpark</title>
  <meta name="generator" content="Hexo 4.1.1"><link rel="alternate" href="/atom.xml" title="sshpark" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="mobile-header-logo">
    <a href="/." class="logo">sshpark</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">é¦–é¡µ
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">å½’æ¡£
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">æ ‡ç­¾
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">å…³äº
          </li>
      </a><a href="/links/">
        <li class="mobile-menu-item">å‹é“¾
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">sshpark</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            é¦–é¡µ
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            å½’æ¡£
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            æ ‡ç­¾
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            å…³äº
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/links/">
            å‹é“¾
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">ç”¨C++å’ŒSFMLå†™æ¸¸æˆ-è®©æˆ‘ä»¬çš„ç²¾çµåŠ¨èµ·æ¥ï¼ˆ6ï¼‰
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-08-31
        </span><span class="post-visits"
             data-url="/2019/08/31/%E7%94%A8C-%E5%92%8CSFML%E5%86%99%E6%B8%B8%E6%88%8F-%E8%AE%A9%E6%88%91%E4%BB%AC%E7%9A%84%E7%B2%BE%E7%81%B5%E5%8A%A8%E8%B5%B7%E6%9D%A5-6/"
             data-title="ç”¨C++å’ŒSFMLå†™æ¸¸æˆ-è®©æˆ‘ä»¬çš„ç²¾çµåŠ¨èµ·æ¥ï¼ˆ6ï¼‰">
          é˜…è¯»æ¬¡æ•° 0
        </span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¸€è·å–æ—¶é—´"><span class="toc-text">ä¸€ã€è·å–æ—¶é—´</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sftime-å’Œ-sfclock"><span class="toc-text">sf::Time å’Œ sf::Clock</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#äºŒè®©ç²¾çµåŠ¨èµ·æ¥"><span class="toc-text">äºŒã€è®©ç²¾çµåŠ¨èµ·æ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æ­¥éª¤"><span class="toc-text">æ­¥éª¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¸‰åˆ›å»ºåŠ¨ç”»åŸºç±»"><span class="toc-text">ä¸‰ã€åˆ›å»ºåŠ¨ç”»åŸºç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å››ä½¿ç”¨-animator"><span class="toc-text">å››ã€ä½¿ç”¨ Animator</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å±•ç¤ºéƒ¨åˆ†"><span class="toc-text">å±•ç¤ºéƒ¨åˆ†</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#äº”å¤šä¸ªåŠ¨ç”»æ•ˆæœ"><span class="toc-text">äº”ã€å¤šä¸ªåŠ¨ç”»æ•ˆæœ</span></a></li></ol>
    </div>
  </div><div class="post-content"><p>åœ¨æ¸¸æˆä¸­ä½¿ç”¨åŠ¨ç”»æ•ˆæœçš„è¯èƒ½å¤Ÿä½¿æˆ‘ä»¬çš„å¯¹è±¡æ›´åŠ æ ©æ ©å¦‚ç”Ÿã€‚ä¾‹å¦‚ï¼Œåœ¨æœ‰ä¸€ä¸ªç¯ç«ç²¾çµï¼Œå¦‚æœå®ƒä»…ä»…æ˜¯ä¸€å¼ é™æ€çš„ç«ç„°å›¾ç‰‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹åˆ°çš„ç«ç„°ä¼¼ä¹æ²¡æœ‰åœ¨ç‡ƒçƒ§ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šå¼ å›¾ç‰‡è®©å®ƒåŠ¨èµ·æ¥ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿™ç¯‡æ–‡ç« å°†è¦ä»‹ç»çš„ã€‚è¿™é‡Œï¼Œå°†ä¼šè®²åˆ°ï¼š</p>
<ul>
<li>è·å–æ—¶é—´</li>
<li>åŠ¨ç”»ç²¾çµ</li>
<li>åˆ›å»º<strong>åŠ¨ç”»</strong>åŸºç±»</li>
</ul>
<a id="more"></a>
<p></br></p>
<h3 id="ä¸€è·å–æ—¶é—´">ä¸€ã€è·å–æ—¶é—´</h3>
<p>åœ¨ <strong>SFML</strong> ä¸­æ—¶é—´æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸œè¥¿ã€‚å®ƒçš„é‡è¦æ€§åœ¨ç³»åˆ—çš„<a href="http://www.sshpark.com.cn/2019/06/05/%E7%94%A8C++%E5%92%8CSFML%E5%86%99%E6%B8%B8%E6%88%8F-Game%E7%B1%BB%E7%9A%84%E5%88%9B%E5%BB%BA%EF%BC%882%EF%BC%89/" target="_blank" rel="noopener">ç¬¬äºŒç¯‡</a>ä¸­ä¹Ÿæåˆ°è¿‡ã€‚æ¸¸æˆä¸–ç•Œä¸­å˜åŒ–åŸºäºæ—¶é—´è€Œä¸æ˜¯å¸§æ•°çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸ä¼šå› ä¸ºç”µè„‘æ€§èƒ½ä¸åŒè€Œäº§ç”Ÿæ¸¸æˆä¸­ç‰©ä½“ç§»åŠ¨é€Ÿåº¦ä¸ä¸€æ ·çš„bugã€‚è¿™é‡Œå†æ¥å¤ä¹ ä¸€ä¸‹ç›¸å…³çš„æ—¶é—´å‡½æ•°ã€‚</p>
<p></br></p>
<h4 id="sftime-å’Œ-sfclock">sf::Time å’Œ sf::Clock</h4>
<p><code>sf::Time</code>ç±»æ˜¯æˆ‘ä»¬çš„æ—¶é—´å•ä½ï¼Œåœ¨ <strong>SFML</strong> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>sf::seconds()</code>ï¼Œ <code>sf::milliseconds()</code>ï¼Œ <code>sf::microseconds()</code> å»åˆå§‹åŒ–æˆ‘ä»¬çš„æ—¶é—´å¯¹è±¡ï¼ˆç§’ã€æ¯«ç§’ã€å¾®ç§’ï¼‰ã€‚ä½¿ç”¨ <code>Time::asSeconds()</code>ï¼Œ <code>Time::asMilliseconds()</code>ï¼Œ <code>Time::asMicroseconds()</code>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sf::Time time = sf::seconds(<span class="number">5</span>) + sf::milliseconds(<span class="number">100</span>);</span><br><span class="line"><span class="keyword">if</span> (time &gt; sf::seconds(<span class="number">5.09</span>))</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"It works"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<p></br></p>
<p><code>sf::Clock</code> ç±»èƒ½å¤Ÿè®©æˆ‘ä»¬å»è·å–<strong>å·²ç»è¿‡å»çš„æ—¶é—´é•¿çŸ­</strong>ï¼Œæ—¶é—´çš„è®¡ç®—æ˜¯åŸºäºæ“ä½œç³»ç»Ÿæ—¶é’Ÿçš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sf::Clock clock;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿è¡Œä¸€æ®µä»£ç </span></span><br><span class="line"></span><br><span class="line">sf::Time timePassed = clock.getElapsedTime();</span><br></pre></td></tr></table></figure>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œ<code>Clock::restart()</code> ä¹Ÿèƒ½å¤Ÿè·å–<strong>å·²ç»è¿‡å»çš„æ—¶é—´é•¿çŸ­</strong>ï¼Œä½†åŒæ—¶å®ƒä¼šå°†æ—¶é’Ÿé‡ç½®ã€‚</p>
<p></br></p>
<p>é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»æ˜ç™½å¦‚ä½•è·å–ä¸€å¸§çš„æ—¶é—´äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sf::Time deltaTime;</span><br><span class="line">sf::Clock clock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (window.isOpen()) &#123;</span><br><span class="line">    <span class="comment">// è·å–ä¸¤å¸§ä¹‹é—´çš„æ—¶é—´</span></span><br><span class="line">    deltaTime = clock.restart();</span><br><span class="line">    <span class="keyword">float</span> dtAsSeconds = deltaTime.asSeconds();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Handle input</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Update frame</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Render frame</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="äºŒè®©ç²¾çµåŠ¨èµ·æ¥">äºŒã€è®©ç²¾çµåŠ¨èµ·æ¥</h3>
<p>å®ç°åŠ¨ç”»çš„ä¼ ç»Ÿæ–¹å¼æ˜¯åˆ©ç”¨å¤šå¼ å›¾ç‰‡åœ¨çŸ­æ—¶é—´å†…ç»˜åˆ¶å‡ºæ¥ï¼Œè¿›è€Œå®ç°åŠ¨ç”»æ•ˆæœã€‚è™½ç„¶è¿™ç§æ–¹æ³•ç›®å‰ä»ç„¶è¢«å¤§é‡é‡‡ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰æ›´å¤šä¼˜é›…çš„åšæ³•ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬åªæ¢è®¨ä¼ ç»Ÿçš„åšæ³•ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå®ƒè¶³ä»¥ä¸ºæˆ‘ä»¬çš„ç²¾çµèµ‹äºˆç”Ÿå‘½ã€‚</p>
<h4 id="æ­¥éª¤">æ­¥éª¤</h4>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯¹è±¡çš„å¤šå¼ å›¾ç‰‡ä»¥ä¾¿æˆ‘ä»¬å»å®ç°å®ƒã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šå°†å®ƒæ”¾åœ¨ä¸€å¼ å›¾ç‰‡é‡Œï¼Œè¿™å¼ å›¾ç‰‡ä¿å­˜äº†è¿™ä¸ªå¯¹è±¡çš„ä¸åŒåŠ¨ä½œã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬çš„ç²¾çµå¤§å°æ˜¯ 32*32 ï¼Œæ€»å…±æœ‰ 8 å¸§ã€‚</p>
<p><img src="http://sshpark.github.io/images/20190831155105.png" width="500px" /></p>
<p>ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºäº†æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sf::<span class="function">Vector2i <span class="title">spriteSize</span><span class="params">(<span class="number">32</span>, <span class="number">32</span>)</span></span>;</span><br><span class="line">sf::<span class="function">Sprite <span class="title">sprite</span><span class="params">(AssetManager::GetTexture(<span class="string">"crystal.png"</span>))</span></span>;</span><br><span class="line"><span class="comment">// è®¾ç½®ç¬¬ä¸€å¸§çš„å›¾ç‰‡</span></span><br><span class="line">sprite.setTextureRect(sf::IntRect(<span class="number">0</span>, <span class="number">0</span>, spriteSize.x, spriteSize.y));</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> framesNum = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">float</span> animationDuration = <span class="number">1</span>; <span class="comment">// 1 ç§’</span></span><br></pre></td></tr></table></figure>
<p><code>AssetManager</code>ç±»æ˜¯æˆ‘ä»¬ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä»‹ç»çš„èµ„æºç®¡ç†å™¨ã€‚ç„¶åï¼Œä¸Šé¢çš„ä»£ç æ˜¯æ˜¾ç¤ºäº†ç¬¬ä¸€å¸§å›¾ç‰‡ï¼Œ8 å¸§æ˜¾ç¤ºå®Œå…¨éœ€è¦ 1 ç§’ï¼Œä¹Ÿå°±æ˜¯æ¯éš” 0.125 ç§’æ˜¾ç¤ºã€‚</p>
<p>é‚£ä¹ˆï¼Œå®Œæ•´çš„æ˜¾ç¤ºåº”è¯¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(window.isOpen()) &#123;</span><br><span class="line">    <span class="comment">// è¿”å›ä¸¤å¸§ç»è¿‡çš„æ—¶é—´</span></span><br><span class="line">    sf::Time deltaTime = clock.restart();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç´¯è®¡ç»è¿‡çš„æ€»æ—¶é—´</span></span><br><span class="line">    elapsedTime += deltaTime;</span><br><span class="line">    <span class="keyword">float</span> timeAsSeconds = elapsedTime.asSeconds();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> animFrame = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;((timeAsSeconds / animatorDuration) * framesNum) % framesNum;</span><br><span class="line">    <span class="comment">// æˆªå–æ˜¾ç¤ºçš„å›¾ç‰‡</span></span><br><span class="line">    sprite.setTextureRect(sf::IntRect(animFrame*spriteSize.x, <span class="number">0</span>, spriteSize.x, spriteSize.y));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è·å–äº†ä¸Šä¸€å¸§åˆ°å½“å‰å¸§ç»è¿‡çš„æ—¶é—´ï¼Œç„¶åå°†å…¶ç´¯åŠ åˆ° <code>elapsedTime</code>ã€‚æœ€åä¸¤è¡Œä»£ç å†³å®šäº†å½“å‰å¸§åº”è¯¥æ˜¾ç¤ºå“ªå¼ å›¾ç‰‡ã€‚</p>
<p><code>(timeAsSeconds / animatorDuration) * framesNum</code> å¾—åˆ°çš„æ˜¯ç»˜åˆ¶åˆ°ç¬¬å‡ å¸§ã€‚å› ä¸ºæ¯ <code>animatorDuration/framesNum</code> ç»˜åˆ¶ä¸€å¸§ã€‚æœ€åå–æ•´å¯¹ <code>framesNum</code> å–æ¨¡å¾—åˆ°ç¬¬å‡ å¸§ï¼ˆå› ä¸ºæˆ‘ä»¬æ—¶é—´æ˜¯ä¸€ç›´ç´¯è®¡çš„ï¼‰ã€‚</p>
<p><strong>æ•ˆæœå¦‚ä¸‹ï¼š</strong></p>
<p><img src="http://sshpark.github.io/images/20190831163323.gif" width="300px" /></p>
<p></br></p>
<h3 id="ä¸‰åˆ›å»ºåŠ¨ç”»åŸºç±»">ä¸‰ã€åˆ›å»ºåŠ¨ç”»åŸºç±»</h3>
<p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›å¯¹å…¶ä»–çš„ç²¾çµç±»ä¹Ÿå–å¾—åŒæ ·çš„æ•ˆæœçš„è¯è¯¥æ€ä¹ˆåŠï¼Ÿå†™ä¸€ä»½è·Ÿä¸Šé¢ä¸€æ¨¡ä¸€æ ·çš„ä»£ç ï¼Ÿæ˜¾ç„¶ï¼Œæˆ‘ä»¬æ˜¯ä¸æ¨èè¿™ç§åšæ³•çš„ï¼Œå› æ­¤ï¼Œè¿™é‡Œåšä¸ªæŠ½è±¡ï¼Œåˆ›å»ºä¸€ä¸ªåŠ¨ç”»ç±»ï¼ˆanimatorï¼‰ã€‚</p>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬çš„åŠ¨ç”»ç±»ï¼ˆanimatorï¼‰åº”è¯¥å…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li>èƒ½è®©ç²¾çµå®ç°åŠ¨ç”»</li>
<li>èƒ½å¤Ÿè®¾ç½®åŠ¨ç”»çš„å‘¨æœŸä»¥åŠä¸€ä¸ªå‘¨æœŸéœ€è¦çš„å¸§æ•°</li>
<li>èƒ½å¤Ÿè®¾ç½®å¤šä¸ªåŠ¨ç”»æ•ˆæœï¼ˆanimationï¼‰</li>
<li>èƒ½å¤Ÿåˆ‡æ¢åŠ¨ç”»æ•ˆæœï¼ˆanimationï¼‰</li>
<li>æ¯ä¸ªç²¾çµæœ‰å…¶å¯¹åº”çš„åŠ¨ç”»ç±»</li>
<li>ç®€å•æ˜“ç”¨</li>
<li>èƒ½å¤Ÿè‡ªåŠ¨é€‰æ‹©å½“å‰æ˜¾ç¤ºçš„å¸§</li>
</ul>
<p>å› ä¸ºæˆ‘ä»¬å¯¹äºæ¯ä¸ªåŠ¨ç”»ç±»ï¼ˆanimatorï¼‰èƒ½å¤Ÿæœ‰å¤šç§ç±»å‹åŠ¨ç”»æ•ˆæœï¼ˆanimationï¼‰ã€‚å› æ­¤ï¼ŒåŠ¨ç”»æ•ˆæœä½¿ç”¨ç»“æ„ä½“å®ç°èƒ½å¤Ÿå‡å°‘ä»£ç é‡ã€‚</p>
<p>åŠ¨ç”»æ•ˆæœï¼ˆanimationï¼‰éœ€è¦æœ‰<strong>å‘¨æœŸæ—¶é—´ï¼Œå¸§åˆ—è¡¨ï¼Œçº¹ç†ï¼Œå¾ªç¯ä¿¡æ¯ï¼ˆæ˜¯å¦æ˜¯å¾ªç¯ï¼Ÿï¼‰ä»¥åŠä¸€ä¸ªåç§°</strong>ã€‚å› æ­¤<code>Animation</code>ä»£ç ä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Animation</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> m_Name;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> m_TextureName;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;sf::IntRect&gt; m_Frames;</span><br><span class="line">    sf::Time m_Duration;</span><br><span class="line">    <span class="keyword">bool</span> m_looping;</span><br><span class="line"></span><br><span class="line">    Animation(<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp; name, <span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp; textureName, </span><br><span class="line">        sf::Time <span class="keyword">const</span>&amp; duration, <span class="keyword">bool</span> looping)</span><br><span class="line">    : m_Name(name), m_TextureName(textureName),</span><br><span class="line">    m_Duration(duration), m_looping(looping) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddFrames</span><span class="params">(sf::Vector2i <span class="keyword">const</span>&amp; startFrom, </span></span></span><br><span class="line"><span class="function"><span class="params">        sf::Vector2i <span class="keyword">const</span>&amp; frameSize, <span class="keyword">unsigned</span> <span class="keyword">int</span> frames)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        sf::Vector2i current = startFrom;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; frames; i++) &#123;</span><br><span class="line">            m_Frames.push_back(sf::IntRect(current.x, current.y, frameSize.x, frameSize.y));</span><br><span class="line">            current.x += frameSize.x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><code>AddFrames()</code> æ–¹æ³•èƒ½å¤Ÿå°†å›¾ç‰‡æŒ‰ç…§æ°´å¹³æ–¹å‘åˆ‡å‰²æˆæ¯ä¸€å¸§å­˜å…¥<code>m_Frames</code>ã€‚</p>
<p>ç°åœ¨æ¥çœ‹çœ‹ <code>Animator</code>ç±»çš„å®ç°ã€‚è¿™ä¸ªç±»èƒ½å¤Ÿä¸ºç²¾çµæ·»åŠ <code>Animation</code>ã€‚é¦–å…ˆçš„è¯å®ƒèƒ½å¤Ÿ<strong>åˆ›å»ºå’Œå­˜å‚¨</strong>åŠ¨ç”»æ•ˆæœ<code>Animation</code>ï¼Œå…¶æ¬¡ï¼Œç”±äº<code>Animation</code>æ˜¯åŸºäºæ—¶é—´å˜åŒ–çš„ï¼Œå®ƒè¿˜éœ€è¦ä¸€ä¸ª<code>Animatot::Update()</code>æ–¹æ³•å»<strong>æ›´æ–°</strong>ã€‚æœ€åï¼Œä¸€ä¸ªä¸æ˜¯å¾ˆé‡è¦çš„æ–¹æ³•<code>Animator::SwitchAnimation()</code>èƒ½å¤Ÿåˆ‡æ¢åŠ¨ç”»æ•ˆæœã€‚åŸºäºè¿™äº›æƒ³æ³•ï¼Œæˆ‘ä»¬çš„ <code>Animator</code> ç±»å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">// é€šè¿‡åå­—æŸ¥æ‰¾å·²ç»æ·»åŠ è¿‡çš„åŠ¨ç”»æ•ˆæœ Animation</span></span><br><span class="line">    Animator::<span class="function">Animation* <span class="title">FindAnimation</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp; name)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">SwitchAnimation</span><span class="params">(Animator::Animation* animation)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// sprite çš„å¼•ç”¨</span></span><br><span class="line">    sf::Sprite&amp; m_Sprite;</span><br><span class="line">    sf::Time m_CurrentTime;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">list</span>&lt;Animator::Animation&gt; m_Animations;</span><br><span class="line">    Animator::Animation* m_CurrentAnimation;</span><br></pre></td></tr></table></figure>
<p>å…ˆä¸çœ‹ <code>FindAnimation()</code> å’Œ <code>SwitchAnimation()</code> è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œåé¢ä¼šæåˆ°ã€‚</p>
<p>å…ˆæ¥çœ‹çœ‹é‡Œé¢å®šä¹‰çš„æ•°æ®ï¼Œ <strong>Sprite</strong> ä¸æ˜¯å®šä¹‰åœ¨ <code>Animitor</code> é‡Œé¢çš„å®ä¾‹ï¼Œæ˜¯ä¸€ä¸ªå¼•ç”¨ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„ç²¾çµæ˜¯åœ¨å¤–éƒ¨å®šä¹‰çš„ï¼Œç„¶ååœ¨ <code>Animitor</code> çš„æ„é€ æ–¹æ³•ä¸­è·å–è¿™ä¸ªå¼•ç”¨ã€‚</p>
<p>å…¶æ¬¡ï¼Œ<code>m_CurrentTime</code> æ˜¯<strong>æ—¶é—´ç´¯åŠ å™¨</strong>ï¼Œä½œç”¨è·Ÿå‰é¢æåˆ°çš„ä¸€æ ·ã€‚<code>m_Animations</code> ä¿å­˜äº†æ‰€æœ‰åŠ¨ç”»æ•ˆæœï¼Œè¿™é‡Œä¸ç”¨ <code>vector</code> è€Œæ˜¯ç”¨ <code>list</code> æ˜¯å› ä¸º <code>vector</code> ä¸èƒ½ä¸èƒ½ä¿å­˜æŒ‡é’ˆæˆ–è€…å¼•ç”¨ç±»å‹ã€‚</p>
<p><font color="orange">å†æ¥çœ‹çœ‹å…¶ä¸­çš„å…¬æœ‰æˆå‘˜ï¼š</font></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Animation</span> &#123;</span>...&#125;;</span><br><span class="line"></span><br><span class="line">    Animator(sf::Sprite&amp; sprite);</span><br><span class="line"></span><br><span class="line">    Animator::<span class="function">Animation&amp; <span class="title">CreateAnimation</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp; name,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp; textureName, sf::Time <span class="keyword">const</span>&amp; duration, <span class="keyword">bool</span> loop = <span class="literal">false</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">(sf::Time <span class="keyword">const</span>&amp; dt)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¯å¦åˆ‡æ¢æˆåŠŸ</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">SwitchAnimation</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp; name)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">GetCurrentAnimationName</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure>
<p><code>Animation</code> å®šä¹‰åœ¨é‡Œé¢æ˜¯å› ä¸ºå®ƒåœ¨å¤–éƒ¨å¹¶ä¸ä¼šç»å¸¸è¢«ç”¨åˆ°ï¼Œæ¥ä¸‹æ¥æ˜¯ <code>Animator</code> çš„æ„é€ å‡½æ•°ï¼Œä¼ å…¥çš„æ˜¯ <strong>Sprite</strong> çš„å¼•ç”¨å»åˆå§‹åŒ–é‡Œé¢çš„ <code>m_Sprite</code> å­—æ®µã€‚</p>
<p><code>Animator::CreateAnimation()</code> é€šè¿‡ç»™å®šçš„å‚æ•°åˆ›å»ºä¸€ä¸ª<strong>åŠ¨ç”»æ•ˆæœ</strong>ã€‚</p>
<p><code>Animator::Update()</code> èƒ½å¤Ÿåœ¨æŸä¸€æ—¶åˆ»è·å–æ­£ç¡®æ˜¾ç¤ºçš„å¸§</p>
<p><code>Animator::SwitchAnimation()</code> èƒ½å¤Ÿä¸ºç²¾çµåˆ‡æ¢åŠ¨ç”»æ•ˆæœ</p>
<p></br></p>
<p>æ¥ä¸‹æ¥çœ‹çœ‹å®ç°å…·ä½“å®ç°</p>
<p>æ„é€ å‡½æ•° <code>Animator()</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Animator::Animator(sf::Sprite&amp; sprite)</span><br><span class="line">    : m_Sprite(sprite), m_CurrentTime(), m_CurrentAnimation(<span class="literal">nullptr</span>) &#123;&#125;</span><br></pre></td></tr></table></figure>
<p><code>Animator::CreateAnimation()</code>ï¼Œåˆ›å»ºåŠ¨ç”»æ•ˆæœå¹¶å­˜å…¥ <code>m_Animations</code> ä¸­ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Animator::Animation&amp; Animator::CreateAnimation(<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp; name,</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp; textureName, sf::Time <span class="keyword">const</span>&amp; duration, <span class="keyword">bool</span> loop) &#123;</span><br><span class="line">    </span><br><span class="line">    m_Animations.push_back(</span><br><span class="line">        Animator::Animation(name, textureName, duration, loop));</span><br><span class="line">	<span class="comment">// å¦‚æœå½“å‰æ²¡æœ‰åŠ¨ç”»æ•ˆæœï¼Œåˆ™ä½¿ç”¨åˆšæ·»åŠ åŠ¨ç”»æ•ˆæœ</span></span><br><span class="line">    <span class="keyword">if</span> (m_CurrentAnimation == <span class="literal">nullptr</span>)</span><br><span class="line">        SwitchAnimation(&amp;m_Animations.back());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m_Animations.back();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>void Animator::SwitchAnimation()</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> Animator::SwitchAnimation(Animator::Animation* animation) &#123;</span><br><span class="line">    <span class="comment">// æ”¹å˜ç²¾çµçš„çº¹ç†</span></span><br><span class="line">    <span class="keyword">if</span> (animation != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        m_Sprite.setTexture(AssetManager::GetTexture(animation-&gt;m_TextureName));</span><br><span class="line">    &#125;</span><br><span class="line">    m_CurrentAnimation = animation;</span><br><span class="line">    m_CurrentTime = sf::Time::Zero; <span class="comment">// é‡ç½®æ—¶é—´</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>bool Animator::SwitchAnimation()</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ˜¯å¦åˆ‡æ¢æˆåŠŸ</span></span><br><span class="line"><span class="keyword">bool</span> Animator::SwitchAnimation(<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp; name) &#123;</span><br><span class="line">    <span class="keyword">auto</span> animation = FindAnimation(name);</span><br><span class="line">    <span class="keyword">if</span> (animation != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        SwitchAnimation(animation);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Animator::Animation* Animator::FindAnimation()</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Animator::Animation* Animator::FindAnimation(<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp; name) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> it = m_Animations.begin(); it != m_Animations.end(); it++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (it-&gt;m_Name == name) &#123;</span><br><span class="line">            <span class="keyword">return</span> &amp;*it;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>std::string Animator::GetCurrentAnimationName()</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> Animator::GetCurrentAnimationName() <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (m_CurrentAnimation != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> m_CurrentAnimation-&gt;m_Name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>void Animator::Update()</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> Animator::Update(sf::Time <span class="keyword">const</span>&amp; dt) &#123;</span><br><span class="line">    <span class="keyword">if</span> (m_CurrentAnimation == <span class="literal">nullptr</span>) <span class="keyword">return</span> ;</span><br><span class="line"></span><br><span class="line">    m_CurrentTime += dt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å½“å‰å¸§</span></span><br><span class="line">    <span class="keyword">float</span> scaledTime = m_CurrentTime.asSeconds() / m_CurrentAnimation-&gt;m_Duration.asSeconds();</span><br><span class="line">    <span class="keyword">int</span> numFrames = m_CurrentAnimation-&gt;m_Frames.size();</span><br><span class="line">    <span class="keyword">int</span> currentFrame = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(scaledTime * numFrames);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœåŠ¨ç”»åœ¨è¿›è¡Œï¼Œåˆ™è®¡ç®—å½“å‰å¸§</span></span><br><span class="line">    <span class="keyword">if</span> (m_CurrentAnimation-&gt;m_Looping) &#123;</span><br><span class="line">        currentFrame %= numFrames;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentFrame &gt;= numFrames) &#123; <span class="comment">// å¦‚æœå½“å‰å¸§ä¸å°äºæ€»çš„å¸§æ•°ï¼Œè®¾ä¸ºæœ€åä¸€å¸§</span></span><br><span class="line">        currentFrame = numFrames<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// è®¾ç½®ä¸ºå½“å‰å¸§</span></span><br><span class="line">    m_Sprite.setTextureRect(m_CurrentAnimation-&gt;m_Frames[currentFrame]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p></br></p>
<h3 id="å››ä½¿ç”¨-animator">å››ã€ä½¿ç”¨ Animator</h3>
<p>è¿˜æ˜¯ä½¿ç”¨ä¸Šé¢çš„å›¾ç‰‡æ¥å®ç°åŠ¨ç”»ç²¾çµ</p>
<p><img src="http://sshpark.github.io/images/20190831155105.png" width="500px" /></p>
<p><strong>åˆå§‹åŒ–éƒ¨åˆ†</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sf::<span class="function">Vector2i <span class="title">spriteSize</span><span class="params">(<span class="number">118</span>, <span class="number">114</span>)</span></span>;</span><br><span class="line">sf::Sprite sprite;</span><br><span class="line"><span class="function">Animator <span class="title">animator</span><span class="params">(sprite)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªåŠ¨ç”»æ•ˆæœå¹¶è·å–å®ƒçš„å¼•ç”¨</span></span><br><span class="line"><span class="keyword">auto</span>&amp; idleAnimation = animator.CreateAnimation(<span class="string">"Idle"</span>, <span class="string">"crystal.png"</span>,</span><br><span class="line">        sf::seconds(<span class="number">1</span>), <span class="literal">true</span>);</span><br><span class="line"><span class="comment">// ä¸ºåŠ¨ç”»æ·»åŠ å¸§</span></span><br><span class="line">idleAnimation.AddFrames(sf::Vector2i(<span class="number">0</span>, <span class="number">0</span>), spriteSize, <span class="number">8</span>);</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºåŠ¨ç”»ä¹‹å‰å¿…é¡»è¦æœ‰ä¸€ä¸ª <strong>sprite</strong> å®ä¾‹ï¼Œè¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªåŠ¨ç”»æ•ˆæœã€‚åŠ¨ç”»æ•ˆæœçš„åå­—æ˜¯ <strong>"Idle"</strong>ï¼Œä½¿ç”¨çš„æ˜¯ <strong>"crystal.png"</strong> å›¾ç‰‡ï¼Œè®¾ç½®å®ƒçš„åŠ¨ç”»å‘¨æœŸä¸º 1 ç§’ä¸”æ­£åœ¨å±•ç¤ºåŠ¨ç”»ä¸­ã€‚</p>
<h4 id="å±•ç¤ºéƒ¨åˆ†">å±•ç¤ºéƒ¨åˆ†</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sf::Clock clock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(window.isOpen()) &#123;</span><br><span class="line"></span><br><span class="line">    sf::Time dt = clock.restart();</span><br><span class="line"></span><br><span class="line">    animator.Update(dt);</span><br><span class="line"></span><br><span class="line">    window.clear();</span><br><span class="line">    window.draw(sprite);</span><br><span class="line">    window.display();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœè·Ÿå‰é¢çš„æ˜¯ä¸€æ ·çš„ã€‚</p>
<p></br></p>
<h3 id="äº”å¤šä¸ªåŠ¨ç”»æ•ˆæœ">äº”ã€å¤šä¸ªåŠ¨ç”»æ•ˆæœ</h3>
<p>åˆ›å»ºä¸€ä¸ªåŠ¨ç”»æ•ˆæœçš„è¯å¾ˆç›´è§‚ã€‚é‚£ä¹ˆå¦‚æœæ˜¯å¤šä¸ªåŠ¨ç”»æ•ˆæœå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å‡è®¾æœ‰è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œå¹¶ä¸”æˆ‘ä»¬æœ‰ä¸¤å¼ å›¾ç‰‡ï¼š<em>spriteSheet.png</em> å’Œ <em>myTexture.png</em>ï¼Œç„¶åæˆ‘ä»¬å¸Œæœ›æœ‰ 4 ç§åŠ¨ç”»æ•ˆæœã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Animator <span class="title">animator</span><span class="params">(sprite)</span></span>;</span><br><span class="line"><span class="comment">// Idle åŠ¨ç”» 8 å¸§ / 1 ç§’</span></span><br><span class="line"><span class="keyword">auto</span>&amp; idleAnimation = animator.CreateAnimation(<span class="string">"Idle"</span>, <span class="string">"spriteSheet.png"</span>, sf::seconds(<span class="number">1</span>), <span class="literal">true</span>);</span><br><span class="line">idleAnimation.AddFrames(sf::Vector2i(<span class="number">0</span>, <span class="number">0</span>), spriteSize, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// IdleShort åŠ¨ç”» 8 å¸§ / 0.5 ç§’</span></span><br><span class="line"><span class="keyword">auto</span>&amp; idleAnimationShort = animator.CreateAnimation(<span class="string">"IdleShort"</span>, <span class="string">"spriteSheet.png"</span>, sf::seconds(<span class="number">0.5f</span>), <span class="literal">true</span>);</span><br><span class="line">idleAnimationShort.AddFrames(sf::Vector2i(<span class="number">0</span>, <span class="number">0</span>), spriteSize, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// IdleSmall åŠ¨ç”» 5 å¸§ / 1.5 ç§’</span></span><br><span class="line"><span class="keyword">auto</span>&amp; idleAnimationSmall = animator.CreateAnimation(<span class="string">"IdleSmall"</span>, <span class="string">"myTexture.png"</span>, sf::seconds(<span class="number">1.5f</span>), <span class="literal">true</span>);</span><br><span class="line">idleAnimationSmall.AddFrames(sf::Vector2i(<span class="number">64</span>, <span class="number">0</span>), spriteSize, <span class="number">3</span>);</span><br><span class="line">idleAnimationSmall.AddFrames(sf::Vector2i(<span class="number">64</span>, <span class="number">32</span>), spriteSize, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// IdleSmall åŠ¨ç”» 8 å¸§ / 0.5 ç§’ï¼Œä¸åœ¨æ‰§è¡ŒåŠ¨ç”»çŠ¶æ€</span></span><br><span class="line"><span class="keyword">auto</span>&amp; idleAnimationOnce = animator.CreateAnimation(<span class="string">"IdleOnce"</span>, <span class="string">"myTexture.png"</span>, sf::seconds(<span class="number">0.5f</span>), <span class="literal">false</span>);</span><br><span class="line">idleAnimationOnce.AddFrames(sf::Vector2i(<span class="number">0</span>, <span class="number">0</span>), spriteSize, <span class="number">8</span>);</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯é€šè¿‡é”®ç›˜äº‹ä»¶åˆ‡æ¢åŠ¨ç”»æ•ˆæœ</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sf::Event ev;</span><br><span class="line"><span class="keyword">while</span> (window.pollEvent(ev)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (ev.type == sf::Event::KeyPressed) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ev.key.code == sf::KeyBoard::Key::Num1)</span><br><span class="line">            animator.SwitchAnimation(<span class="string">"Idle"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ev.key.code == sf::KeyBoard::Key::Num2)</span><br><span class="line">            animator.SwitchAnimation(<span class="string">"IdleShort"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ev.key.code == sf::KeyBoard::Key::Num3)</span><br><span class="line">            animator.SwitchAnimation(<span class="string">"IdleSmall"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ev.key.code == sf::KeyBoard::Key::Num4)</span><br><span class="line">            animator.SwitchAnimation(<span class="string">"IdleOnce"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<p>ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œ<code>Animator</code> ç±»ä½¿å¾—åŠ¨ç”»æ›´æ˜“äºç®¡ç†ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œå®ƒå…·æœ‰æé«˜çš„å¯æ‰©å±•æ€§ã€‚</p>
<p>ç¤ºä¾‹ä»£ç åœ¨ <a href="https://github.com/sshpark/LearnSFML/tree/master/blog6" target="_blank" rel="noopener">Github</a></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä¼šä»‹ç» <strong>æ‘„åƒæœº</strong> å’Œ <strong>OpenGL</strong>ï¼Œå°½è¯·æœŸå¾…ğŸ˜ƒã€‚</p>

      </div>
      
      <footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/SFML/">SFML</a>
            <a href="/tags/%E7%94%A8C-%E5%92%8CSFML%E5%86%99%E6%B8%B8%E6%88%8F/">ç”¨C++å’ŒSFMLå†™æ¸¸æˆ</a>
            </div>
        
        <nav class="post-nav"><a class="prev" href="/2019/09/05/%E7%94%A8%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E6%80%9D%E6%83%B3%E5%AE%9E%E7%8E%B0-Logistic-%E5%9B%9E%E5%BD%92/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">ç”¨ç¥ç»ç½‘ç»œæ€æƒ³å®ç° Logistic å›å½’</span>
        <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
      </a>
    <a class="next" href="/2019/08/28/%E7%94%A8C-%E5%92%8CSFML%E5%86%99%E6%B8%B8%E6%88%8F-%E7%BA%B9%E7%90%86%E5%8F%8A%E7%B2%BE%E7%81%B5%EF%BC%885-2%EF%BC%89/">
        <span class="next-text nav-default">ç”¨C++å’ŒSFMLå†™æ¸¸æˆ-çº¹ç†åŠç²¾çµï¼ˆ5.2ï¼‰</span>
        <span class="prev-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"><div id="utterances-container"></div>
    </div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:sshpark@163.com" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/sshpark" target="_blank" rel="noopener" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even" target="_blank" rel="noopener">Even</a>
  </span>

  <span class="copyright-year">
    ç²¤ICPå¤‡17102498å·
  </span>

  <span class="copyright-year">&copy;2017 - 2021<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Sshpark</span>

  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script>
    var container = document.getElementById('utterances-container')
    var script = document.createElement('script')
    script.src = 'https://utteranc.es/client.js'
    script.setAttribute('repo', 'sshpark/MASM')
    script.setAttribute('issue-term', 'title')
    script.setAttribute('theme', 'github-light')
    script.setAttribute('label', 'utterances')
    script.crossorigin = 'anonymous'
    script.async = true

    container.appendChild(script)
  </script><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
